# Banana Blog 环境变量配置示例
# 复制此文件为 .env 并填入实际的 API Key

# Flask 配置
FLASK_ENV=development
SECRET_KEY=your-secret-key-here

# AI Provider 配置 (openai 或 gemini)
AI_PROVIDER_FORMAT=openai

# AI 模型配置
TEXT_MODEL=qwen3-max-preview
LLM_MAX_TOKENS=8192

# OpenAI 兼容 API 配置
OPENAI_API_KEY=your-openai-api-key-here
OPENAI_API_BASE=https://dashscope.aliyuncs.com/compatible-mode/v1

# 日志级别
LOG_LEVEL=INFO

# CORS 配置
CORS_ORIGINS=*

# Nano Banana Pro API（用于 AI 封面图生成）
NANO_BANANA_API_KEY=your-nano-banana-api-key-here
NANO_BANANA_API_BASE=https://grsai.dakka.com.cn
NANO_BANANA_MODEL=nano-banana-pro

# 智谱 Web Search API（用于深度调研）
ZAI_SEARCH_API_KEY=your-zhipu-api-key-here
ZAI_SEARCH_API_BASE=https://open.bigmodel.cn/api/paas/v4/web_search
ZAI_SEARCH_ENGINE=search_pro_quark
ZAI_SEARCH_MAX_RESULTS=5
ZAI_SEARCH_CONTENT_SIZE=medium
ZAI_SEARCH_RECENCY_FILTER=noLimit

# MinerU PDF 解析 API（用于文档解析）
MINERU_TOKEN=your-mineru-token-here
MINERU_API_BASE=https://mineru.net
PDF_MAX_PAGES=15

# 知识融合配置
KNOWLEDGE_MAX_CONTENT_LENGTH=8000
KNOWLEDGE_MAX_DOC_ITEMS=10
KNOWLEDGE_CHUNK_SIZE=2000
KNOWLEDGE_CHUNK_OVERLAP=200

# 多模态模型配置（用于图片摘要）
IMAGE_CAPTION_MODEL=qwen3-vl-plus-2025-12-19

# 阿里云 OSS 配置（用于上传封面图获取公网 URL，生成动画需要）
OSS_ACCESS_KEY_ID=your-oss-access-key-id
OSS_ACCESS_KEY_SECRET=your-oss-access-key-secret
OSS_BUCKET_NAME=your-bucket-name
OSS_ENDPOINT=oss-cn-hangzhou.aliyuncs.com

# Veo3 视频生成配置（复用 NANO_BANANA_API_KEY）
VEO3_MODEL=veo3.1-fast
VIDEO_OUTPUT_FOLDER=

# vibe-reviewer 配置
# vibe-reviewer页面显示开关
REVIEWER_ENABLED=false
REVIEWER_MAX_CHAPTERS=5

# 博客生成并行配置
# 代码/图片生成的最大并行数（单个任务内部）
BLOG_GENERATOR_MAX_WORKERS=3

# 智能知识源搜索配置
# 是否启用智能搜索（LLM 路由 + 多源并行搜索）
SMART_SEARCH_ENABLED=true
AI_BOOST_ENABLED=true
MULTI_ROUND_SEARCH_ENABLED=true
RESEARCHER_CACHE_ENABLED=true
CACHE_TTL_HOURS=24

# 多轮搜索结果数量（按博客长度分级）
MULTI_SEARCH_MAX_MINI=1
MULTI_SEARCH_MAX_SHORT=3
MULTI_SEARCH_MAX_MEDIUM=5
MULTI_SEARCH_MAX_LONG=8
MULTI_SEARCH_MAX_CUSTOM=5

# 书籍扫描聚合配置
# 是否启用扫描聚合按钮
BOOK_SCAN_ENABLED=false

# 封面动画配置
# 是否显示生成封面动画选项
COVER_VIDEO_ENABLED=true

# 小红书 Tab 配置
# 是否显示小红书生成 Tab（实验性功能）
XHS_TAB_ENABLED=false

# LLM 弹性调用配置（截断扩容、智能重试、超时保护）
LLM_CALL_TIMEOUT=600
LLM_MAX_RETRIES=5
LLM_RETRY_BASE_WAIT=5
LLM_RETRY_MAX_WAIT=60
LLM_TRUNCATION_EXPAND_RATIO=1.1
AGENT_RUNNER_MAX_RETRIES=2

# 推理引擎 Extended Thinking（37.03）
THINKING_ENABLED=false
THINKING_BUDGET_TOKENS=19000

# 上下文长度守卫配置（动态估算与自动裁剪）
CONTEXT_GUARD_ENABLED=true
CONTEXT_SAFETY_MARGIN=0.85
CONTEXT_ESTIMATION_METHOD=auto

# Token 追踪与成本分析配置
TOKEN_TRACKING_ENABLED=true
TOKEN_COST_ESTIMATION=false

# 结构化任务日志配置
BLOG_TASK_LOG_ENABLED=true
BLOG_LOGS_DIR=logs/blog_tasks

# SSE 流式事件增量优化配置（37.34）
SSE_LLM_EVENTS_ENABLED=true
SSE_TOKEN_SUMMARY_ENABLED=true

# 统一 ToolManager 配置（37.09）
TOOL_BLACKLIST=
TOOL_DEFAULT_TIMEOUT=300

# Serper Google 搜索配置（75.02）
SERPER_API_KEY=your-serper-api-key-here
SERPER_TIMEOUT=10
SERPER_MAX_RESULTS=10

# 搜狗搜索配置（75.07 腾讯云 SearchPro）
TENCENTCLOUD_SECRET_ID=your-tencentcloud-secret-id
TENCENTCLOUD_SECRET_KEY=your-tencentcloud-secret-key
SOGOU_SEARCH_TIMEOUT=10
SOGOU_MAX_RESULTS=10

# 多提供商 LLM 客户端工厂（37.29）
# 各提供商 API Key（按需配置，有哪个 Key 就支持哪个提供商）
# ANTHROPIC_API_KEY=sk-ant-xxx
# DEEPSEEK_API_KEY=sk-xxx
# DASHSCOPE_API_KEY=sk-xxx
# ZHIPU_API_KEY=xxx.xxx
# 默认模型（用户不选时使用，留空则使用 TEXT_MODEL）
DEFAULT_LLM_PROVIDER=openai
DEFAULT_LLM_MODEL=

# 上下文压缩策略配置（37.06）
CONTEXT_COMPRESSION_ENABLED=true
CONTEXT_SEARCH_MAX_RESULTS=10
CONTEXT_REVISION_KEEP_LAST=2

# ============ 新集成模块（默认关闭，按需开启） ============

# Jina 深度抓取（75.03）— 对搜索结果 Top N 进行全文抓取
DEEP_SCRAPE_ENABLED=false
JINA_API_KEY=your-jina-api-key-here
DEEP_SCRAPE_TOP_N=3
DEEP_SCRAPE_TIMEOUT=30

# 本地素材库（75.06）— 从本地目录检索预存素材
LOCAL_MATERIAL_ENABLED=false
LOCAL_MATERIAL_DIR=materials

# 知识空白检测器（75.04）— LLM 驱动的知识缺口分析，替代规则匹配
KNOWLEDGE_GAP_DETECTOR_ENABLED=false

# 分层校验（37.12）— 校验各 Agent 层之间的数据契约，仅输出日志
LAYER_VALIDATION_ENABLED=false

# 衍生物生成（37.14/37.16）— 博客生成后自动产出思维导图/闪卡/学习笔记
SKILL_DERIVATIVES_ENABLED=false

# ============ 调用链追踪配置（Langfuse） ============
# 启用后可在 Langfuse Cloud 查看 LLM 调用链路、耗时、Token 费用
TRACE_ENABLED=false
LANGFUSE_SECRET_KEY=sk-lf-your-secret-key-here
LANGFUSE_PUBLIC_KEY=pk-lf-your-public-key-here
LANGFUSE_BASE_URL=https://cloud.langfuse.com

# ============ Agent 开关（默认全部开启） ============
HUMANIZER_ENABLED=true
HUMANIZER_SKIP_THRESHOLD=40
HUMANIZER_MAX_RETRIES=1
THREAD_CHECK_ENABLED=true
VOICE_CHECK_ENABLED=true
FACTCHECK_ENABLED=true
FACTCHECK_SKIP_THRESHOLD=4
FACTCHECK_AUTO_FIX=true
TEXT_CLEANUP_ENABLED=true
SUMMARY_GENERATOR_ENABLED=true

# ============ 配图与 Mermaid 配置 ============
IMAGE_ENHANCEMENT_ENABLED=false
IMAGE_ENHANCEMENT_TIMEOUT=60
IMAGE_REFINE_ENABLED=false
IMAGE_REFINE_MAX_ROUNDS=2
IMAGE_REFINE_THRESHOLD=8.0
MERMAID_REPAIR_MAX_RETRIES=2

# ============ 实验性功能 ============
# Crawl4AI 主动爬取（需安装 crawl4ai）
CRAWL4AI_ENABLED=false
MATERIALS_DIR=materials

# ============ 飞书机器人（对话式写作入口） ============
# 在飞书开发者后台创建企业自建应用后获取
FEISHU_APP_ID=
FEISHU_APP_SECRET=
FEISHU_VERIFICATION_TOKEN=
FEISHU_ENCRYPT_KEY=
