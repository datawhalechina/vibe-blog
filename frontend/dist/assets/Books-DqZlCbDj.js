import{d as z,q as D,c as i,a as e,e as y,b as C,w as V,t as o,k as v,F as j,r as F,m as E,g as B,n as k,h as d,j as K,o as c,A as M,p as A,B as G,z as H,_ as I}from"./index-CX2luUoy.js";const L={class:"terminal-nav"},O={class:"terminal-nav-right"},R={class:"container"},q={class:"page-title"},W={class:"code-comment"},J={class:"code-number"},Q={class:"terminal-cmd-bar"},U=["disabled"],X={class:"code-cards-grid"},Y={key:0,class:"loading-state"},Z={key:1,class:"empty-state"},ss=["data-theme","onClick","onKeydown"],es={class:"code-card-header"},as={class:"code-card-body"},ts={class:"code-line"},os={class:"code-string"},ns={class:"code-line"},ds={class:"code-number"},ls={class:"code-line"},rs={class:"code-number"},is={class:"code-comment"},cs={class:"code-card-footer"},ps={class:"card-icon"},vs={key:0,class:"progress-modal"},us={class:"terminal-panel"},ms={class:"terminal-panel-body"},bs={class:"code-line"},gs={class:"code-comment"},ys={class:"progress-bar"},_s={class:"progress-percent"},fs={class:"toast-icon"},ks=z({__name:"Books",setup(ws){const x=G(),u=d(!1),m=d([]),_=d(!0),b=d(!1),l=d({show:!1,message:"",type:"info"}),f=d(!1),p=d(0),g=d("analyzing blog content..."),T={ai:"ü§ñ",web:"üåê",data:"üìä",devops:"‚öôÔ∏è",security:"üîê",general:"üìñ"},S=a=>T[a||"general"]||"üìñ",N=a=>a>=1e4?(a/1e4).toFixed(1)+"‰∏á":a.toString(),r=(a,s="info")=>{l.value={show:!0,message:a,type:s},setTimeout(()=>{l.value.show=!1},3e3)},w=async()=>{_.value=!0;try{const s=await(await fetch("/api/books")).json();s.success?m.value=s.books||[]:r("Âä†ËΩΩÂ§±Ë¥•: "+s.error,"error")}catch(a){r("Âä†ËΩΩÂ§±Ë¥•: "+a.message,"error")}finally{_.value=!1}},h=async()=>{if(b.value)return;b.value=!0,f.value=!0,p.value=0;const a=[{progress:20,status:"analyzing blog content..."},{progress:40,status:"detecting book themes..."},{progress:60,status:"generating outlines..."}];for(const s of a)await new Promise(n=>setTimeout(n,500)),p.value=s.progress,g.value=s.status;try{const n=await(await fetch("/api/books/regenerate",{method:"POST",headers:{"Content-Type":"application/json"}})).json();p.value=80,g.value="generating covers...",await new Promise(t=>setTimeout(t,500)),p.value=100,g.value="done!",await new Promise(t=>setTimeout(t,500)),n.success?(r(`Êâ´ÊèèÂÆåÊàê: ÂàõÂª∫ ${n.books_created||0} Êú¨Êñ∞‰π¶, Êõ¥Êñ∞ ${n.books_updated||0} Êú¨`,"success"),w()):r("Êâ´ÊèèÂ§±Ë¥•: "+(n.error||"Êú™Áü•ÈîôËØØ"),"error")}catch(s){r("Êâ´ÊèèÂ§±Ë¥•: "+s.message,"error")}finally{f.value=!1,b.value=!1}},$=a=>{if(console.log("üîµ Opening book clicked:",a),!a){console.error("‚ùå Book ID is empty"),r("‰π¶Á±ç ID Êó†Êïà","error");return}console.log("‚úÖ Navigating to:",`/book/${a}`),x.push(`/book/${a}`).catch(s=>{console.error("‚ùå Navigation error:",s),r("ÂØºËà™Â§±Ë¥•: "+s.message,"error")})};return D(()=>{w()}),(a,s)=>{const n=K("router-link");return c(),i("div",{class:k(["books-container",{"dark-mode":u.value}])},[e("nav",L,[s[3]||(s[3]=y('<div class="terminal-nav-left" data-v-5d960b97><div class="terminal-dots" data-v-5d960b97><span class="dot red" data-v-5d960b97></span><span class="dot yellow" data-v-5d960b97></span><span class="dot green" data-v-5d960b97></span></div><span class="terminal-title" data-v-5d960b97>$ ls ~/books/</span></div>',1)),e("div",O,[s[2]||(s[2]=e("a",{href:"https://github.com/datawhalechina/vibe-blog",target:"_blank",rel:"noopener noreferrer",class:"nav-cmd",title:"GitHub - vibe-blog"},"GitHub",-1)),C(n,{to:"/",class:"nav-cmd"},{default:V(()=>[...s[1]||(s[1]=[v("cd ~/blog",-1)])]),_:1}),e("button",{class:"theme-toggle",onClick:s[0]||(s[0]=t=>u.value=!u.value)},o(u.value?"‚òÄÔ∏è":"üåô"),1)])]),e("div",R,[e("div",q,[s[6]||(s[6]=e("h1",null,"> ÊàëÁöÑ‰π¶Êû∂_",-1)),e("p",W,[s[4]||(s[4]=v("// total: ",-1)),e("span",J,o(m.value.length),1),s[5]||(s[5]=v(" books",-1))])]),e("div",Q,[s[7]||(s[7]=y('<div class="terminal-dots-sm" data-v-5d960b97><span class="dot red" data-v-5d960b97></span><span class="dot yellow" data-v-5d960b97></span><span class="dot green" data-v-5d960b97></span></div><span class="cmd-prompt" data-v-5d960b97>$</span><span class="cmd-text" data-v-5d960b97>./scan_books.sh --regenerate</span>',3)),e("button",{class:"execute-btn",disabled:b.value,onClick:h},"> run",8,U)]),e("div",X,[_.value?(c(),i("div",Y,[...s[8]||(s[8]=[e("div",{class:"code-line"},[e("span",{class:"code-prompt"},"$"),v(" loading...")],-1),e("div",{class:"spinner"},null,-1)])])):m.value.length===0?(c(),i("div",Z,[s[9]||(s[9]=y('<div class="empty-terminal" data-v-5d960b97><div class="code-line" data-v-5d960b97><span class="code-prompt" data-v-5d960b97>$</span> ls ~/books/</div><div class="code-line" data-v-5d960b97><span class="code-comment" data-v-5d960b97>// directory is empty</span></div><div class="code-line" data-v-5d960b97><span class="code-prompt" data-v-5d960b97>$</span> <span class="cursor-blink" data-v-5d960b97>_</span></div></div>',1)),e("button",{class:"cmd-btn primary",onClick:h},"> scan_books")])):(c(!0),i(j,{key:2},F(m.value,t=>(c(),i("div",{key:t.id,class:"code-card","data-theme":t.theme||"general",onClick:A(P=>$(t.id),["stop"]),role:"button",tabindex:0,onKeydown:M(P=>$(t.id),["enter"])},[e("div",es,[s[10]||(s[10]=e("div",{class:"card-folder"},[e("span",{class:"folder-icon"},"üìÅ"),e("span",{class:"folder-name"},"books/")],-1)),e("span",{class:k(["card-theme",`theme-${t.theme||"general"}`])},o(t.theme||"general"),3)]),e("div",as,[e("div",ts,[s[11]||(s[11]=e("span",{class:"line-num"},"1",-1)),s[12]||(s[12]=e("span",{class:"code-keyword"},"const",-1)),s[13]||(s[13]=e("span",{class:"code-variable"},"title",-1)),s[14]||(s[14]=e("span",{class:"code-operator"},"=",-1)),e("span",os,'"'+o(t.title)+'"',1)]),e("div",ns,[s[15]||(s[15]=e("span",{class:"line-num"},"2",-1)),s[16]||(s[16]=e("span",{class:"code-keyword"},"const",-1)),s[17]||(s[17]=e("span",{class:"code-variable"},"chapters",-1)),s[18]||(s[18]=e("span",{class:"code-operator"},"=",-1)),e("span",ds,o(t.chapters_count||0),1)]),e("div",ls,[s[19]||(s[19]=e("span",{class:"line-num"},"3",-1)),s[20]||(s[20]=e("span",{class:"code-keyword"},"const",-1)),s[21]||(s[21]=e("span",{class:"code-variable"},"words",-1)),s[22]||(s[22]=e("span",{class:"code-operator"},"=",-1)),e("span",rs,o(t.total_word_count||0),1),e("span",is,"// "+o(N(t.total_word_count||0)),1)]),s[23]||(s[23]=e("div",{class:"code-line command-line"},[e("span",{class:"code-prompt"},"$"),e("span",{class:"code-cmd"},"cat README.md")],-1))]),e("div",cs,[e("div",ps,o(S(t.theme)),1),s[24]||(s[24]=e("span",{class:"card-arrow"},"‚Üí",-1))])],40,ss))),128))])]),f.value?(c(),i("div",vs,[e("div",us,[s[25]||(s[25]=y('<div class="terminal-panel-header" data-v-5d960b97><div class="terminal-dots-sm" data-v-5d960b97><span class="dot red" data-v-5d960b97></span><span class="dot yellow" data-v-5d960b97></span><span class="dot green" data-v-5d960b97></span></div><span class="panel-title" data-v-5d960b97>$ ./scan_books.sh</span></div>',1)),e("div",ms,[e("div",bs,[e("span",gs,"// "+o(g.value),1)]),e("div",ys,[e("div",{class:"progress-fill",style:E({width:p.value+"%"})},null,4)]),e("div",_s,o(p.value)+"%",1)])])])):B("",!0),l.value.show?(c(),i("div",{key:1,class:k(["toast",l.value.type])},[e("span",fs,o(l.value.type==="success"?"‚úì":l.value.type==="error"?"‚úó":"‚Ñπ"),1),v(" "+o(l.value.message),1)],2)):B("",!0),C(H)],2)}}}),$s=I(ks,[["__scopeId","data-v-5d960b97"]]);export{$s as default};
